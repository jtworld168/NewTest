<view class="container">
  <!-- Tabs -->
  <view class="tabs">
    <view class="tab {{currentTab === item.key ? 'active' : ''}}" wx:for="{{tabs}}" wx:key="key" bindtap="switchTab" data-tab="{{item.key}}">
      <text>{{item.name}}</text>
    </view>
  </view>

  <!-- Order List -->
  <view class="order-list" wx:if="{{!loading}}">
    <block wx:for="{{orders}}" wx:key="id">
      <view class="order-card" wx:if="{{currentTab === 'all' || item.status === currentTab}}" bindtap="goToOrderDetail" data-id="{{item.id}}">
        <view class="order-header">
          <text class="order-id">è®¢å•å·: {{item.id}}</text>
          <text class="order-status status-{{item.status}}">
            {{item.status === 'PENDING' ? 'å¾…æ”¯ä»˜' : item.status === 'PAID' ? 'å·²æ”¯ä»˜' : item.status === 'COMPLETED' ? 'å·²å®Œæˆ' : 'å·²å–æ¶ˆ'}}
          </text>
        </view>

        <view class="order-body">
          <image class="order-product-image" src="{{item._imageUrl || '/images/product-placeholder.png'}}" mode="aspectFill"></image>
          <view class="order-product-info">
            <text class="order-product-name">{{item._productName || 'å•†å“'}}</text>
            <text class="order-quantity">x{{item.quantity}}</text>
            <text class="order-price">å•ä»·: Â¥{{item.priceAtPurchase}}</text>
          </view>
        </view>

        <view class="order-footer">
          <text class="order-time" wx:if="{{item.createTime}}">{{item.createTime}}</text>
          <view class="order-total">
            <text class="order-discount-tag" wx:if="{{item._hasEmployeeDiscount}}">å‘˜å·¥æŠ˜æ‰£</text>
            <text class="order-coupon-tag" wx:if="{{item.userCouponId}}">å·²ç”¨åˆ¸</text>
            <text>åˆè®¡: </text>
            <text class="price">Â¥{{item.totalAmount}}</text>
          </view>
        </view>

        <!-- Action buttons for pending orders -->
        <view class="order-actions" wx:if="{{item.status === 'PENDING'}}">
          <button class="btn-cancel" catchtap="cancelOrder" data-id="{{item.id}}">å–æ¶ˆè®¢å•</button>
          <button class="btn-pay" catchtap="goToPay" data-id="{{item.id}}" data-amount="{{item.totalAmount}}">å»æ”¯ä»˜</button>
        </view>
      </view>
    </block>
  </view>

  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <view class="empty-state" wx:if="{{!loading && orders.length === 0}}">
    <text class="empty-icon">ğŸ“‹</text>
    <text class="empty-text">æš‚æ— è®¢å•</text>
  </view>
</view>
