<view class="container">
  <!-- Store Selector -->
  <view class="store-selector">
    <picker mode="selector" range="{{storeNames}}" bindchange="onStoreChange">
      <view class="store-picker">
        <text class="store-icon">ğŸª</text>
        <text class="store-name">{{selectedStoreName}}</text>
        <text class="store-arrow">â–¼</text>
      </view>
    </picker>
  </view>

  <!-- Search Bar with Scan Button -->
  <view class="search-bar">
    <view class="search-input" bindtap="goToCategory">
      <text class="search-icon">ğŸ”</text>
      <text class="search-placeholder">æœç´¢å•†å“</text>
    </view>
    <view class="scan-btn" bindtap="onScan">
      <text class="scan-icon">ğŸ“·</text>
    </view>
  </view>

  <!-- Swiper Banner (local images) -->
  <view class="swiper-section">
    <swiper class="banner-swiper" indicator-dots autoplay interval="{{3000}}" circular>
      <swiper-item wx:for="{{banners}}" wx:key="id">
        <view class="banner-item" bindtap="goToCategory">
          <image class="banner-image" src="{{item.image}}" mode="aspectFill"></image>
          <view class="banner-overlay">
            <text class="banner-text">{{item.title}}</text>
            <text class="banner-sub">{{item.subtitle}}</text>
          </view>
        </view>
      </swiper-item>
    </swiper>
  </view>

  <!-- Category Quick Links -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">å•†å“åˆ†ç±»</text>
      <text class="section-more" bindtap="goToCategory">æŸ¥çœ‹å…¨éƒ¨ ></text>
    </view>
    <scroll-view class="category-scroll" scroll-x="true">
      <view class="category-item" wx:for="{{categories}}" wx:key="id" bindtap="goToCategoryDetail" data-id="{{item.id}}">
        <view class="category-icon">ğŸ“¦</view>
        <text class="category-name">{{item.name}}</text>
      </view>
    </scroll-view>
  </view>

  <!-- Product List (Single Column) -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">çƒ­é—¨å•†å“</text>
    </view>
    <view class="product-list" wx:if="{{!loading}}">
      <view class="product-row" wx:for="{{products}}" wx:key="id">
        <image class="product-row-image" src="{{item._imageUrl || '/images/product-placeholder.png'}}" mode="aspectFill" bindtap="goToProductDetail" data-id="{{item.id}}"></image>
        <view class="product-row-info">
          <text class="product-name" bindtap="goToProductDetail" data-id="{{item.id}}">{{item.name}}</text>
          <text class="product-desc" wx:if="{{item.description}}">{{item.description}}</text>
          <view class="product-bottom">
            <view class="price-area">
              <text class="price">Â¥{{item._displayPrice}}</text>
              <text class="original-price" wx:if="{{item._isEmployee}}">Â¥{{item.price}}</text>
              <text class="employee-tag" wx:if="{{item._isEmployee}}">å†…è´­ä»·</text>
            </view>
            <view class="product-qty-control">
              <view class="product-qty-btn" bindtap="decreaseQty" data-id="{{item.id}}">-</view>
              <text class="product-qty-num">{{item._cartQty || 0}}</text>
              <view class="product-qty-btn {{item._bouncing ? 'cart-bounce' : ''}}" bindtap="increaseQty" data-id="{{item.id}}">+</view>
            </view>
          </view>
        </view>
      </view>
    </view>
    <view class="loading" wx:if="{{loading}}">
      <text>åŠ è½½ä¸­...</text>
    </view>
    <view class="empty-state" wx:if="{{!loading && products.length === 0}}">
      <text class="empty-icon">ğŸ›’</text>
      <text class="empty-text">æš‚æ— å•†å“</text>
    </view>
  </view>

  <!-- Cart drop animation ball -->
  <view class="cart-drop-ball" wx:if="{{showDropBall}}" style="left:{{dropBallX}}px;top:{{dropBallY}}px;" animation="{{dropBallAnimation}}">
    <view class="drop-ball-inner">+1</view>
  </view>
</view>
